# 人脸识别服务开发任务文档

## 一、任务介绍

### 1. 任务目标  
本任务旨在通过实践掌握人脸识别技术的基本原理与应用，实现一个基于开源人脸识别模块的服务端程序，能够接收用户上传的图片并识别人脸，返回识别结果。任务要求使用现有开源人脸识别库（如 `face_recognition`、`dlib`、`OpenCV` 等）完成系统搭建和服务部署。

### 2. 技术要求  
- 使用 Python 语言开发；
- 采用 Flask/FastAPI 构建接口服务；
- 使用至少一个主流开源人脸识别库；
- 支持 RESTful API；
- 接口支持单张图片上传，返回识别结果；
- 支持在本地完成测试部署。

### 3. 任务目标分解  
- 搭建基本人脸识别服务框架；
- 实现人脸检测与特征提取；
- 构建本地人脸库（至少包括3个样本人物，每人至少2张照片）；
- 实现人脸比对与身份识别；
- 部署API服务，支持图片上传与识别；
- 编写接口文档和测试用例。

---

## 二、输入输出接口服务描述

### 1. 接口1：人脸识别接口

- **接口路径**：`/api/recognize`
- **请求方法**：`POST`
- **请求类型**：`multipart/form-data`
- **请求参数**：

| 参数名   | 类型     | 是否必填 | 描述                     |
|--------|--------|--------|------------------------|
| image  | file   | 是      | 上传的人脸图片文件（JPG/PNG） |

- **响应参数**（JSON格式）：

```json
{
  "success": true,
  "faces": [
    {
      "location": [top, right, bottom, left],
      "name": "person_name_1",
      "confidence": 0.92
    },
    {
      "location": [top, right, bottom, left],
      "name": "unknown",
      "confidence": 0.0
    }
  ],
  "message": "识别完成"
}
```

- **说明**：
  - `location`：人脸在图像中的位置；
  - `name`：识别出的人脸名称，未识别则为 `unknown`；
  - `confidence`：匹配置信度，0-1之间。

---

## 三、测试用例设计

### 测试用例1：上传已注册人脸图片  
- **输入**：张三的正面人脸图像（位于本地人脸库中）  
- **预期输出**：
  ```json
  {
    "success": true,
    "faces": [
      {
        "location": [...],
        "name": "张三",
        "confidence": >0.85
      }
    ],
    "message": "识别完成"
  }
  ```

### 测试用例2：上传未注册人脸图片  
- **输入**：某个不在本地人脸库中的人脸图像  
- **预期输出**：
  ```json
  {
    "success": true,
    "faces": [
      {
        "location": [...],
        "name": "unknown",
        "confidence": 0.0
      }
    ],
    "message": "识别完成"
  }
  ```

### 测试用例3：上传多张人脸图片  
- **输入**：包含两张不同人脸的合照，张三与李四（两者均已注册）  
- **预期输出**：
  ```json
  {
    "success": true,
    "faces": [
      {
        "location": [...],
        "name": "张三",
        "confidence": >0.85
      },
      {
        "location": [...],
        "name": "李四",
        "confidence": >0.85
      }
    ],
    "message": "识别完成"
  }
  ```

### 测试用例4：上传非人脸图像  
- **输入**：一张风景图  
- **预期输出**：
  ```json
  {
    "success": true,
    "faces": [],
    "message": "未检测到人脸"
  }
  ```

### 测试用例5：上传错误格式的文件  
- **输入**：一个 `.txt` 文件  
- **预期输出**：
  ```json
  {
    "success": false,
    "message": "无效的图像文件格式"
  }
  ```

